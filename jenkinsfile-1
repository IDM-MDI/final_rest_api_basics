pipeline {
  agent any
  stages {
      stage('build') {
        steps {
            bat './mvnw clean verify'
        }
      }
      stage('Scan') {
        steps {
            withSonarQubeEnv(installationName: 'sonar1') {
              bat 'sonar:sonar -Dproject.settings=../sonar-project.properties'
            }
        }
      }
      stage("Quality gate") {
         steps {
            waitForQualityGate abortPipeline: true
         }
      }
      stage('Deploy'){
        steps {
            bat 'copy "web/target/certificate-1.0.war" "%Tomcat_Path%/webapps"'
        }
      }
      stage('Start-Tomcat'){
         steps {
             bat 'cd "%Tomcat_Path%\bin"'
             bat 'startup.bat'
         }
      }
  }
}